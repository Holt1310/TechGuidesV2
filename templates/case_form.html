{% extends 'layout.html' %}
{% block content %}
<h2>{{ 'Edit' if case else 'New' }} Case - {{ template.name }}</h2>
{% if error %}<div class="alert alert-danger">{{ error }}</div>{% endif %}
<form method="post">
  <input type="hidden" name="template_id" value="{{ template.id }}">
  {% for field in fields %}
  <div class="mb-3">
    <label class="form-label">{{ field.name }}</label>
    {% if field.type == 'textarea' %}
      <textarea name="{{ field.id }}" class="form-control">{{ data.get(field.id, '') }}</textarea>
    {% elif field.type == 'select' %}
      <select name="{{ field.id }}" class="form-select">
        {% for opt in field.options %}
          <option value="{{ opt.value }}" {% if data.get(field.id) == opt.value %}selected{% endif %}>{{ opt.label }}</option>
        {% endfor %}
      </select>
    {% else %}
      <input type="text" name="{{ field.id }}" class="form-control" value="{{ data.get(field.id,'') }}">
    {% endif %}
  </div>
  {% endfor %}
  <button type="submit" class="btn btn-primary">Save</button>
  <a href="{{ url_for('case_list') }}" class="btn btn-secondary">Cancel</a>
</form>
{% endblock %}
